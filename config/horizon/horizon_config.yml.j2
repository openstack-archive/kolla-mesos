{% set apache_dir = 'apache2/conf-enabled' if kolla_base_distro in ['ubuntu', 'debian'] else 'httpd/conf.d' %}
config:
  horizon:
    horizon:
      kolla_mesos_start.py:
        source: kolla_mesos/container_scripts/start.py
        dest: /usr/local/bin/kolla_mesos_start
      000-default.conf:
        source: config/horizon/templates/horizon.conf.j2
        dest: /etc/{{ apache_dir }}/000-default.conf
        owner: apache
        perm: "0600"
      local_settings:
        source: config/horizon/templates/local_settings.j2
        dest: /etc/openstack-dashboard/local_settings
        owner: apache
        perm: "0600"
commands:
  horizon:
    horizon:
      bootstrap:
        command: kolla_extend_start
        run_once: False
        register: /kolla/variables/horizon_bootstrap/.done
      horizon:
        command: /usr/sbin/apache2 -DFOREGROUND
        daemon: False
        run_once: False
        requires: [/kolla/variables/horizon_bootstrap/.done]
